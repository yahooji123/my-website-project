<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üöÄ pdf generator</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tesseract.js/4.1.1/tesseract.min.js"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    :root {
      --primary: #6c5ce7;
      --secondary: #a29bfe;
      --accent: #fd79a8;
      --success: #00b894;
      --danger: #d63031;
      --warning: #fdcb6e;
      --dark: #2d3436;
      --light: #f5f6fa;
      --dark-mode-bg: #1e272e;
      --dark-mode-card: #2f3640;
    }
    
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; transition: all 0.3s; }
    body { background: var(--light); color: var(--dark); }
    body.dark-mode { background: var(--dark-mode-bg); color: white; }
    .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
    h1 { font-size: 2.8rem; margin-bottom: 10px; background: linear-gradient(45deg, var(--primary), var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-align: center; }
    .subtitle { text-align: center; margin-bottom: 30px; color: #666; font-weight: 300; }
    .dark-mode .subtitle { color: #aaa; }
    
    /* Upload Section */
    .upload-section { background: white; border-radius: 15px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); margin-bottom: 30px; }
    .dark-mode .upload-section { background: var(--dark-mode-card); }
    .drag-area { border: 3px dashed var(--primary); border-radius: 12px; padding: 40px; text-align: center; cursor: pointer; margin-bottom: 20px; }
    .drag-area.active { background: rgba(108, 92, 231, 0.1); }
    .drag-area i { font-size: 4rem; margin-bottom: 15px; color: var(--primary); }
    .drag-area p { font-size: 1.2rem; margin-bottom: 15px; }
    input[type="file"] { display: none; }
    .upload-btn { padding: 12px 25px; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; margin: 10px; }
    .upload-btn:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(108, 92, 231, 0.4); }
    
    /* Image Preview Grid */
    #images-preview { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 15px; margin: 20px 0; }
    .image-card { position: relative; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    .image-card img { width: 100%; height: 180px; object-fit: cover; }
    .image-actions { position: absolute; top: 10px; right: 10px; display: flex; gap: 5px; }
    .action-btn { width: 30px; height: 30px; border-radius: 50%; border: none; background: rgba(0,0,0,0.7); color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; }
    .action-btn:hover { background: var(--accent); transform: scale(1.1); }
    
    /* PDF Options (Tabs System) */
    .options-tabs { display: flex; gap: 10px; margin-bottom: 20px; }
    .tab-btn { padding: 10px 20px; background: #eee; border: none; border-radius: 8px 8px 0 0; cursor: pointer; }
    .dark-mode .tab-btn { background: #333; color: white; }
    .tab-btn.active { background: var(--primary); color: white; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    
    /* Option Cards */
    .option-card { background: white; border-radius: 10px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    .dark-mode .option-card { background: var(--dark-mode-card); }
    .option-card h3 { margin-bottom: 15px; color: var(--primary); }
    .form-group { margin-bottom: 15px; }
    label { display: block; margin-bottom: 5px; font-weight: 500; }
    input, select { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ddd; }
    .dark-mode input, .dark-mode select { background: #333; border-color: #555; color: white; }
    
    /* AI Tools Section */
    .ai-tools { display: flex; flex-wrap: wrap; gap: 15px; margin: 20px 0; }
    .ai-tool { background: white; border-radius: 10px; padding: 15px; flex: 1; min-width: 200px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    .dark-mode .ai-tool { background: var(--dark-mode-card); }
    .ai-tool h4 { margin-bottom: 10px; color: var(--accent); }
    
    /* Action Buttons */
    .action-btns { display: flex; gap: 15px; margin: 30px 0; justify-content: center; }
    .main-btn { padding: 15px 30px; font-size: 1.1rem; border-radius: 10px; border: none; cursor: pointer; font-weight: 600; }
    .generate-btn { background: var(--success); color: white; }
    .generate-btn:hover { background: #00a884; transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0, 184, 148, 0.4); }
    .preview-btn { background: var(--primary); color: white; }
    .preview-btn:hover { background: #5a4fcf; transform: translateY(-3px); box-shadow: 0 5px 15px rgba(108, 92, 231, 0.4); }
    .cloud-btn { background: #4285F4; color: white; }
    .cloud-btn:hover { background: #3367d6; transform: translateY(-3px); box-shadow: 0 5px 15px rgba(66, 133, 244, 0.4); }
    
    /* Progress Bar */
    .progress-container { width: 100%; background: #eee; border-radius: 10px; margin: 20px 0; display: none; }
    .dark-mode .progress-container { background: #333; }
    .progress-bar { height: 20px; border-radius: 10px; background: linear-gradient(90deg, var(--primary), var(--accent)); width: 0%; transition: width 0.5s; text-align: center; color: white; font-size: 12px; line-height: 20px; }
    
    /* Dark Mode Toggle */
    .dark-mode-toggle { position: fixed; top: 20px; right: 20px; z-index: 100; }
    .toggle-btn { background: var(--dark); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
    .dark-mode .toggle-btn { background: var(--light); color: var(--dark); }
    
    /* Responsive */
    @media (max-width: 768px) {
      #images-preview { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); }
      .action-btns { flex-direction: column; }
    }
  </style>
</head>
<body>
  <div class="dark-mode-toggle">
    <button class="toggle-btn" id="darkModeToggle">üåô</button>
  </div>
  
  <div class="container">
    <h1>üöÄ PDF Master 9000</h1>
    <p class="subtitle">The World's Most Advanced Image-to-PDF Converter with AI & Cloud Integration</p>
    
    <!-- Upload Section -->
    <div class="upload-section">
      <div class="drag-area" id="dragArea">
        <i>üìÅ</i>
        <p><strong>Drag & Drop Images Here</strong></p>
        <p>or</p>
        <input type="file" id="image-upload" multiple accept="image/*,.pdf" />
        <button class="upload-btn" id="uploadBtn">Browse Files</button>
      </div>
      
      <div id="images-preview"></div>
      
      <div class="action-btns">
        <button class="upload-btn danger" onclick="clearAll()">üóëÔ∏è Clear All</button>
        <button class="upload-btn" onclick="reorderImages()">üîÑ Reorder</button>
      </div>
    </div>
    
    <!-- PDF Options Tabs -->
    <div class="options-tabs">
      <button class="tab-btn active" data-tab="basic-options">Basic</button>
      <button class="tab-btn" data-tab="advanced-options">Advanced</button>
      <button class="tab-btn" data-tab="ai-tools">AI Tools</button>
      <button class="tab-btn" data-tab="cloud-integration">Cloud</button>
    </div>
    
    <!-- Basic Options -->
    <div class="tab-content active" id="basic-options">
      <div class="option-card">
        <h3>üìÑ Document Settings</h3>
        <div class="form-group">
          <label>PDF Name</label>
          <input type="text" id="pdf-name" placeholder="MyDocument" value="MyDocument">
        </div>
        <div class="form-group">
          <label>Page Size</label>
          <select id="page-size">
            <option value="a4">A4</option>
            <option value="letter">Letter</option>
            <option value="legal">Legal</option>
            <option value="a3">A3</option>
          </select>
        </div>
        <div class="form-group">
          <label>Orientation</label>
          <select id="page-orientation">
            <option value="portrait">Portrait</option>
            <option value="landscape">Landscape</option>
          </select>
        </div>
      </div>
      
      <div class="option-card">
        <h3>üé® Appearance</h3>
        <div class="form-group">
          <label>Background Color</label>
          <input type="color" id="bg-color" value="#ffffff">
        </div>
        <div class="form-group">
          <label>Image Quality</label>
          <input type="range" id="image-quality" min="0.1" max="1" step="0.1" value="0.9">
          <span id="quality-value">90%</span>
        </div>
      </div>
    </div>
    
    <!-- Advanced Options -->
    <div class="tab-content" id="advanced-options">
      <div class="option-card">
        <h3>‚öôÔ∏è Advanced PDF Settings</h3>
        <div class="form-group">
          <label>Password Protection</label>
          <input type="password" id="pdf-password" placeholder="Optional password">
        </div>
        <div class="form-group">
          <label>Compression Level</label>
          <select id="compression">
            <option value="low">Low (Best Quality)</option>
            <option value="medium" selected>Medium (Balanced)</option>
            <option value="high">High (Smallest Size)</option>
          </select>
        </div>
      </div>
      
      <div class="option-card">
        <h3>üìë Document Structure</h3>
        <div class="form-group">
          <label>Add Table of Contents</label>
          <input type="checkbox" id="add-toc" checked>
        </div>
        <div class="form-group">
          <label>Add Page Numbers</label>
          <input type="checkbox" id="page-numbers" checked>
        </div>
      </div>
    </div>
    
    <!-- AI Tools -->
    <div class="tab-content" id="ai-tools">
      <div class="ai-tools">
        <div class="ai-tool">
          <h4>üîç OCR (Text Recognition)</h4>
          <p>Extract text from images into searchable PDF</p>
          <input type="checkbox" id="enable-ocr" checked>
        </div>
        <div class="ai-tool">
          <h4>‚úÇÔ∏è Smart Cropping</h4>
          <p>Auto-detect and crop document edges</p>
          <input type="checkbox" id="smart-crop" checked>
        </div>
        <div class="ai-tool">
          <h4>üé® Auto-Enhance</h4>
          <p>Improve image quality automatically</p>
          <input type="checkbox" id="auto-enhance" checked>
        </div>
        <div class="ai-tool">
          <h4>üè∑Ô∏è AI Tagging</h4>
          <p>Automatically generate PDF tags</p>
          <input type="checkbox" id="ai-tagging">
        </div>
      </div>
    </div>
    
    <!-- Cloud Integration -->
    <div class="tab-content" id="cloud-integration">
      <div class="option-card">
        <h3>‚òÅÔ∏è Cloud Storage</h3>
        <p>Save your PDF directly to cloud storage</p>
        <div class="action-btns">
          <button class="cloud-btn" id="googleDriveBtn">Google Drive</button>
          <button class="cloud-btn" id="dropboxBtn">Dropbox</button>
          <button class="cloud-btn" id="oneDriveBtn">OneDrive</button>
        </div>
      </div>
    </div>
    
    <!-- Progress Bar -->
    <div class="progress-container" id="progressContainer">
      <div class="progress-bar" id="progressBar">0%</div>
    </div>
    
    <!-- Main Action Buttons -->
    <div class="action-btns">
      <button class="main-btn generate-btn" onclick="generatePDF()">‚ú® Generate PDF</button>
      <button class="main-btn preview-btn" onclick="previewPDF()">üëÅÔ∏è Preview PDF</button>
    </div>
  </div>

  <script>
    // Initialize JS PDF
    const { jsPDF } = window.jspdf;
    let imageFiles = [];
    
    // Dark Mode Toggle
    const darkModeToggle = document.getElementById('darkModeToggle');
    darkModeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
      darkModeToggle.textContent = document.body.classList.contains('dark-mode') ? '‚òÄÔ∏è' : 'üåô';
    });
    
    // Tab System
    const tabBtns = document.querySelectorAll('.tab-btn');
    tabBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        tabBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        const tabId = btn.getAttribute('data-tab');
        document.querySelectorAll('.tab-content').forEach(content => {
          content.classList.remove('active');
        });
        document.getElementById(tabId).classList.add('active');
      });
    });
    
    // Drag and Drop
    const dragArea = document.getElementById('dragArea');
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(event => {
      dragArea.addEventListener(event, preventDefaults, false);
    });
    
    function preventDefaults(e) {
      e.preventDefault();
      e.stopPropagation();
    }
    
    ['dragenter', 'dragover'].forEach(event => {
      dragArea.addEventListener(event, () => dragArea.classList.add('active'), false);
    });
    
    ['dragleave', 'drop'].forEach(event => {
      dragArea.addEventListener(event, () => dragArea.classList.remove('active'), false);
    });
    
    dragArea.addEventListener('drop', handleDrop, false);
    
    function handleDrop(e) {
      const files = e.dataTransfer.files;
      handleFiles(files);
    }
    
    // File Upload
    document.getElementById('uploadBtn').addEventListener('click', () => {
      document.getElementById('image-upload').click();
    });
    
    document.getElementById('image-upload').addEventListener('change', (e) => {
      handleFiles(e.target.files);
    });
    
    // Handle Uploaded Files
    function handleFiles(files) {
      const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp', 'application/pdf'];
      const validFiles = Array.from(files).filter(file => validTypes.includes(file.type));
      
      if (validFiles.length === 0) {
        alert('Please upload valid files (JPG, PNG, GIF, WEBP, or PDF)');
        return;
      }
      
      imageFiles = [...imageFiles, ...validFiles];
      updatePreview();
    }
    
    // Update Image Preview
    function updatePreview() {
      const preview = document.getElementById('images-preview');
      preview.innerHTML = '';
      
      imageFiles.forEach((file, index) => {
        const reader = new FileReader();
        reader.onload = (e) => {
          const card = document.createElement('div');
          card.className = 'image-card';
          
          const img = document.createElement('img');
          img.src = file.type.includes('image') ? e.target.result : 'https://cdn-icons-png.flaticon.com/512/337/337946.png';
          img.alt = file.name;
          
          const actions = document.createElement('div');
          actions.className = 'image-actions';
          
          const removeBtn = document.createElement('button');
          removeBtn.className = 'action-btn';
          removeBtn.innerHTML = '√ó';
          removeBtn.onclick = () => removeImage(index);
          
          actions.appendChild(removeBtn);
          card.appendChild(img);
          card.appendChild(actions);
          preview.appendChild(card);
        };
        reader.readAsDataURL(file);
      });
    }
    
    // Remove Image
    function removeImage(index) {
      imageFiles.splice(index, 1);
      updatePreview();
    }
    
    // Clear All Images
    function clearAll() {
      imageFiles = [];
      updatePreview();
    }
    
    // Reorder Images (TODO: Implement drag-and-drop reordering)
    function reorderImages() {
      alert('Drag and drop reordering will be implemented in the next update!');
    }
    
    // Generate PDF (Main Function)
    async function generatePDF() {
      if (imageFiles.length === 0) {
        alert('Please upload at least one file');
        return;
      }
      
      // Show progress bar
      const progressContainer = document.getElementById('progressContainer');
      const progressBar = document.getElementById('progressBar');
      progressContainer.style.display = 'block';
      progressBar.style.width = '0%';
      progressBar.textContent = '0%';
      
      try {
        // Get all settings
        const pdfName = document.getElementById('pdf-name').value || 'MyDocument';
        const bgColor = document.getElementById('bg-color').value;
        const pageSize = document.getElementById('page-size').value;
        const orientation = document.getElementById('page-orientation').value;
        const quality = parseFloat(document.getElementById('image-quality').value);
        const password = document.getElementById('pdf-password').value;
        const addTOC = document.getElementById('add-toc').checked;
        const addPageNumbers = document.getElementById('page-numbers').checked;
        const enableOCR = document.getElementById('enable-ocr').checked;
        
        // Initialize PDF
        const pdf = new jsPDF({
          orientation: orientation,
          unit: 'pt',
          format: pageSize
        });
        
        // Process images
        for (let i = 0; i < imageFiles.length; i++) {
          const file = imageFiles[i];
          
          // Update progress
          const progress = Math.round(((i + 1) / imageFiles.length) * 100);
          progressBar.style.width = `${progress}%`;
          progressBar.textContent = `${progress}%`;
          
          // Add new page (except first)
          if (i > 0) pdf.addPage();
          
          // Handle PDF files (merge)
          if (file.type === 'application/pdf') {
            // TODO: Implement PDF merging
            alert('PDF merging will be implemented in the next update!');
            continue;
          }
          
          // Handle images
          const imgData = await loadImage(file, quality);
          const pageWidth = pdf.internal.pageSize.getWidth();
          const pageHeight = pdf.internal.pageSize.getHeight();
          
          // Add background
          pdf.setFillColor(bgColor);
          pdf.rect(0, 0, pageWidth, pageHeight, 'F');
          
          // Add image
          pdf.addImage(imgData, 'JPEG', 20, 20, pageWidth - 40, pageHeight - 40);
          
          // OCR Processing
          if (enableOCR) {
            const text = await performOCR(imgData);
            if (text) {
              pdf.setTextColor('#0000FF');
              pdf.text(`Extracted Text: ${text.substring(0, 100)}...`, 20, pageHeight - 20);
            }
          }
        }
        
        // Add TOC if enabled
        if (addTOC) {
          // TODO: Implement table of contents
        }
        
        // Add page numbers if enabled
        if (addPageNumbers) {
          const pageCount = pdf.internal.getNumberOfPages();
          for (let i = 1; i <= pageCount; i++) {
            pdf.setPage(i);
            pdf.setFontSize(10);
            pdf.setTextColor('#666666');
            pdf.text(`Page ${i} of ${pageCount}`, pdf.internal.pageSize.getWidth() - 50, pdf.internal.pageSize.getHeight() - 20);
          }
        }
        
        // Password protect if specified
        if (password) {
          // TODO: Implement password protection
          alert('Password protection will be implemented in the next update!');
        }
        
        // Save PDF
        pdf.save(`${pdfName}.pdf`);
      } catch (error) {
        console.error('Error generating PDF:', error);
        alert('An error occurred while generating the PDF. Please try again.');
      } finally {
        progressContainer.style.display = 'none';
      }
    }
    
    // Load Image with Quality Control
    function loadImage(file, quality = 0.9) {
      return new Promise((resolve) => {
        const img = new Image();
        img.onload = () => {
          const canvas = document.createElement('canvas');
          canvas.width = img.width;
          canvas.height = img.height;
          const ctx = canvas.getContext('2d');
          ctx.drawImage(img, 0, 0);
          resolve(canvas.toDataURL('image/jpeg', quality));
        };
        img.src = URL.createObjectURL(file);
      });
    }
    
    // Perform OCR using Tesseract.js
    async function performOCR(imageData) {
      try {
        const { data: { text } } = await Tesseract.recognize(imageData, 'eng');
        return text.trim();
      } catch (error) {
        console.error('OCR Error:', error);
        return null;
      }
    }
    
    // Preview PDF (TODO: Implement proper preview)
    function previewPDF() {
      alert('PDF preview will open in a new tab in the final version!');
    }
    
    // Cloud Integration (TODO: Implement)
    document.getElementById('googleDriveBtn').addEventListener('click', () => {
      alert('Google Drive integration coming soon!');
    });
  </script>
</body>
</html>